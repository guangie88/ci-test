language: none

env:
  global:
    - GO_VERSION=1.11.5
    - GOPATH=/root/go
    - PATH=${PATH}:/usr/local/go/bin

matrix:
  include:
    - env: NAME=hello
    - env: NAME=world

build:
  # See: http://docs.shippable.com/ci/custom-docker-image/#minimum-requirements
  # pre_ci_boot:
  #   image_name: some_image
  #   image_tag: latest
  #   pull: true
  pre_ci:
    - curl -sLO https://dl.google.com/go/go${GO_VERSION}.linux-amd64.tar.gz
    - tar -C /usr/local -xf go${GO_VERSION}.linux-amd64.tar.gz
    - rm go${GO_VERSION}.linux-amd64.tar.gz
  ci:
    # Docker artifacts are cached across all builds
    - docker build . --build-arg NAME=${NAME}
    # Try build Go project
    - cd ${GOPATH}
    - go get -v github.com/gruntwork-io/terragrunt
    - cd src/github.com/gruntwork-io/terragrunt
    - go build -v

  cache: true

# jobs:
#   - name: Build Docker image
#     type: runCI

branches:
  only:
    - master
